cmake_minimum_required(VERSION 3.16...3.28 FATAL_ERROR)
project(NSCA_app VERSION 0.3 LANGUAGES C CXX)

# Add NSCA prefix to CMAKE_PREFIX_PATH (already determined in root)
list(APPEND CMAKE_PREFIX_PATH "${NSCA_PREFIX}")

find_package(NSCA REQUIRED)
# ------------------------
# Sources and headers
# ------------------------

set(APP_SRCS    
    "${CMAKE_CURRENT_SOURCE_DIR}/Src/conSys_Version.cpp"
)
set(APP_HDRS
    "${CMAKE_CURRENT_SOURCE_DIR}/Include/Global_Header.h"
    "${CMAKE_CURRENT_SOURCE_DIR}/Internal/foo.h"
)

# ------------------------
# Build executable using helper
# ------------------------
App_builder(${PROJECT_NAME}
    OUTPUT_DIR                  app_dir
    BUILD_DESTINATION_PATH      ${GLOBAL_OUTPUT_DIR}
    WIN32                       OFF
    EXPORT_FLAG                 ""
    SOURCES                     ${APP_SRCS}
    HEADERS                     ${APP_HDRS}
    PUBLIC_INCLUDES             "${CMAKE_CURRENT_SOURCE_DIR}/Include"
    PRIVATE_INCLUDES            "${CMAKE_CURRENT_SOURCE_DIR}/Internal"
    LINK_LIBS                   ws2_32 NSCA::NSCA
)

# ------------------------
# Deploy NSCA DLL automatically
# ------------------------
deploy_dll(NSCA "${NSCA_PREFIX}/bin" ${PROJECT_NAME})